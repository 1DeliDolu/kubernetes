# Adding Windows worker nodes

````markdown
## üöÄ Adding Windows worker nodes / Hinzuf√ºgen von Windows-Worker-Knoten


**Deutsche √úbersetzung:**  
**FEATURE STATUS:** Kubernetes v1.18 [Beta]  
Diese Seite beschreibt, wie man **Windows-Worker-Knoten** zu einem mit **kubeadm** erstellten Cluster hinzuf√ºgt.

---

## üß© Before you begin / Bevor Sie beginnen

- Eine laufende **Windows Server 2022** (oder h√∂her) Instanz mit administrativem Zugriff.  
- Ein laufender **kubeadm-Cluster**, der mit `kubeadm init` erstellt wurde und den Schritten im Dokument **Creating a cluster with kubeadm** folgt.

---

## üß© Adding Windows worker nodes / Hinzuf√ºgen von Windows-Worker-Knoten

> **Hinweis:**  
> Zum Hinzuf√ºgen von Windows-Worker-Knoten zu einem Cluster werden **PowerShell-Skripte** aus dem Repository  
> [https://sigs.k8s.io/sig-windows-tools](https://sigs.k8s.io/sig-windows-tools) verwendet.

F√ºhren Sie auf **jeder Maschine** die folgenden Schritte aus:

1. √ñffnen Sie eine **PowerShell-Sitzung** auf der Maschine.  
2. Stellen Sie sicher, dass Sie **Administrator** oder ein Benutzer mit entsprechenden Berechtigungen sind.  
3. Fahren Sie dann mit den unten beschriebenen Schritten fort.

---

## üß© Install containerd / containerd installieren

> **Hinweis:**  
> In diesem Abschnitt werden Drittanbieterprojekte verlinkt, die von Kubernetes ben√∂tigte Funktionalit√§t bereitstellen.  
> Die Kubernetes-Projektmitarbeitenden sind nicht f√ºr diese Projekte verantwortlich.  
> Eine vollst√§ndige Liste und Richtlinien zur Aufnahme finden Sie im **Content Guide** der Kubernetes-Dokumentation.

F√ºhren Sie zun√§chst den folgenden Befehl aus, um das Installationsskript herunterzuladen:

```powershell
curl.exe -LO https://raw.githubusercontent.com/kubernetes-sigs/sig-windows-tools/master/hostprocess/Install-Containerd.ps1
````

F√ºhren Sie anschlie√üend den folgenden Befehl aus (ersetzen Sie **CONTAINERD_VERSION** durch eine aktuelle Version aus dem containerd-Repository ‚Äì **ohne** Pr√§fix `v`, z. B. `1.7.22` statt `v1.7.22`):

```powershell
.\Install-Containerd.ps1 -ContainerDVersion CONTAINERD_VERSION
```

Passen Sie bei Bedarf weitere Parameter von `Install-Containerd.ps1` an, z. B. `netAdapterName`.
Setzen Sie `skipHypervisorSupportCheck`, wenn Ihr System **kein Hyper-V** unterst√ºtzt und keine Hyper-V-isolierten Container ausf√ºhren kann.

Wenn Sie die optionalen Parameter `CNIBinPath` und/oder `CNIConfigPath` √§ndern, m√ºssen Sie das installierte **Windows CNI Plugin** mit denselben Werten konfigurieren.

---

## üß© Install kubeadm and kubelet / kubeadm und kubelet installieren

Laden Sie das Vorbereitungs-Skript herunter und f√ºhren Sie es aus:

```powershell
curl.exe -LO https://raw.githubusercontent.com/kubernetes-sigs/sig-windows-tools/master/hostprocess/PrepareNode.ps1
.\PrepareNode.ps1 -KubernetesVersion v1.34
```

Passen Sie den Parameter `-KubernetesVersion` nach Bedarf an.

---

## üß© Run kubeadm join / kubeadm join ausf√ºhren

F√ºhren Sie den vom Befehl `kubeadm init` ausgegebenen Join-Befehl aus. Beispiel:

```powershell
kubeadm join --token <token> <control-plane-host>:<control-plane-port> --discovery-token-ca-cert-hash sha256:<hash>
```

---

## üß© Additional information about kubeadm join / Zus√§tzliche Informationen zu kubeadm join

> **Hinweis:**
> Wenn Sie eine IPv6-Adresse f√ºr `<control-plane-host>:<control-plane-port>` verwenden, muss die IPv6-Adresse in eckige Klammern gesetzt werden, z. B. `[2001:db8::101]:2073`.

Falls Sie den Token nicht mehr haben, k√∂nnen Sie ihn auf dem **Control-Plane-Knoten** abrufen:

```bash
sudo kubeadm token list
```

Beispielausgabe:

```
TOKEN                    TTL  EXPIRES              USAGES           DESCRIPTION            EXTRA GROUPS
8ewj1p.9r9hcjoqgajrj4gi  23h  2018-06-12T02:51:28Z authentication,  The default bootstrap  system:
                                                   signing          token generated by     bootstrappers:
                                                                    'kubeadm init'.        kubeadm:
                                                                                           default-node-token
```

Standardm√§√üig laufen Tokens nach **24 Stunden** ab.
Wenn das aktuelle Token abgelaufen ist, erstellen Sie auf dem Control-Plane-Knoten ein neues:

```bash
sudo kubeadm token create
```

Beispielausgabe:

```
5didvk.d09sbcov8ph2amjw
```

Wenn Sie den Wert f√ºr `--discovery-token-ca-cert-hash` ben√∂tigen, k√∂nnen Sie diesen mit folgendem Befehl ermitteln:

```bash
sudo cat /etc/kubernetes/pki/ca.crt | openssl x509 -pubkey  | openssl rsa -pubin -outform der 2>/dev/null | \
   openssl dgst -sha256 -hex | sed 's/^.* //'
```

Beispielausgabe:

```
8cb2de97839780a412b93877f8507ad6c94f73add17d5d7058e91741c9d5ec78
```

Die Ausgabe des Befehls `kubeadm join` sieht etwa so aus:

```
[preflight] Running pre-flight checks

... (log output of join workflow) ...

Node join complete:
* Certificate signing request sent to control-plane and response
  received.
* Kubelet informed of new secure connection details.
```

F√ºhren Sie anschlie√üend auf der Control Plane aus:

```bash
kubectl get nodes
```

Nach einigen Sekunden sollte der neue Windows-Knoten in der Ausgabe erscheinen.

---

## üß© Network configuration / Netzwerkkonfiguration

Das Einrichten von **CNI** in Clustern, die **Linux- und Windows-Knoten** kombinieren, erfordert zus√§tzliche Schritte √ºber das reine Anwenden eines Manifests mit `kubectl apply` hinaus.
Das auf den Control-Plane-Knoten ausgef√ºhrte CNI-Plugin muss so konfiguriert sein, dass es das auf den Windows-Worker-Knoten ausgef√ºhrte CNI-Plugin unterst√ºtzt.

> **Hinweis:**
> Auch dieser Abschnitt verweist auf Drittanbieterprojekte, die von Kubernetes ben√∂tigte Funktionen bereitstellen.
> Nur wenige CNI-Plugins unterst√ºtzen derzeit Windows.
> Nachfolgend finden Sie spezifische Installationsanweisungen f√ºr einige davon:

* **Flannel**
* **Calico**

---

## üß© Install kubectl for Windows (optional) / kubectl f√ºr Windows installieren (optional)

Siehe [Install and Set Up kubectl on Windows](https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/).

```
